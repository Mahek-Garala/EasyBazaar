{% extends 'base.html' %} {% block content %}

<!-- partial:index.partial.html -->
<section class="home-section"  style="margin-top: 80px">
  <h1>Your Cart</h1>
  <div class="products" >
    {% for p in products %}
    <div class="product-card">
      <img
        src="{{ p.product.image.url }}"
        alt="Product Image"
        style="height : 350px; width =  336px ; "
      />
      <div class="product-info">
        <h3>{{p.product.name}}</h3>
        <p class="price">{{p.product.price}}</p>
        <p class="description">{{p.product.description}}</p>
        <p class="quantity">Quantity = {{p.stock}}</p>
      </div>
      <div class="actions" style="gap: 7px">
        <a
          href="{% url 'increase_quantity' p.product.id %}"
          class="btn btn-primary quantity-btn"
          style="padding-left: 10px"
          >Increase</a
        >
        <a
          href="{% url 'decrease_quantity' p.product.id %}"
          class="btn btn-primary quantity-btn"
          style="padding-left: 10px"
          >Decrease</a
        >

        <div class="buttons">
          <a
            href="{% url 'remove_from_cart' p.product.id %}"
            class="btn btn-danger"
            >Remove</a
          >
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <div class="row mt-3">
    <div class="col-md-6">
      <h3>Total Price: &#8377;{{ total_price }}</h3>

      {% if error_message %}
          <div
            style="
              margin: 0px;
              padding: 0px 3px;
              height: fit-content;
              width: 275px;
              box-shadow: 1px 1px 1px 1px red;
            "
          >
            <p
              style="
                margin: 9px 0px;
                color: red;
                font-weight: bold;
                letter-spacing: 0px;
              "
            >
              {{ error_message }}
            </p>
          </div>
          {% endif %}
      <a href="{% url 'buyProduct' %}" class="btn btn-success">Buy Now</a>
        </div>
            
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.4.0/gsap.min.js"></script>
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/MorphSVGPlugin3.min.js"></script>
  <script></script>
</section>
<!-- partial -->
<script src="./catogery.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
<script>
  $(document).ready(function () {
    $(".carousel").slick({
      slidesToShow: 3,
      slidesToScroll: 1,
      autoplay: true,
      autoplaySpeed: 2000,
    });
  });

  gsap.registerPlugin(MorphSVGPlugin);

  document.querySelectorAll(".add-to-cart").forEach((button) => {
    let morph = button.querySelector(".morph path"),
      shirt = button.querySelectorAll(".shirt svg > path");
    button.addEventListener("pointerdown", (e) => {
      if (button.classList.contains("active")) {
        return;
      }
      gsap.to(button, {
        "--background-scale": 0.97,
        duration: 0.15,
      });
    });
    button.addEventListener("click", (e) => {
      e.preventDefault();
      if (button.classList.contains("active")) {
        return;
      }
      button.classList.add("active");
      gsap.to(button, {
        keyframes: [
          {
            "--background-scale": 0.97,
            duration: 0.15,
          },
          {
            "--background-scale": 1,
            delay: 0.125,
            duration: 1.2,
            ease: "elastic.out(1, .6)",
          },
        ],
      });
      gsap.to(button, {
        keyframes: [
          {
            "--shirt-scale": 1,
            "--shirt-y": "-42px",
            "--cart-x": "0px",
            "--cart-scale": 1,
            duration: 0.4,
            ease: "power1.in",
          },
          {
            "--shirt-y": "-40px",
            duration: 0.3,
          },
          {
            "--shirt-y": "16px",
            "--shirt-scale": 0.9,
            duration: 0.25,
            ease: "none",
          },
          {
            "--shirt-scale": 0,
            duration: 0.3,
            ease: "none",
          },
        ],
      });
      gsap.to(button, {
        "--shirt-second-y": "0px",
        delay: 0.835,
        duration: 0.12,
      });
      gsap.to(button, {
        keyframes: [
          {
            "--cart-clip": "12px",
            "--cart-clip-x": "3px",
            delay: 0.9,
            duration: 0.06,
          },
          {
            "--cart-y": "2px",
            duration: 0.1,
          },
          {
            "--cart-tick-offset": "0px",
            "--cart-y": "0px",
            duration: 0.2,
            onComplete() {
              button.style.overflow = "hidden";
            },
          },
          {
            "--cart-x": "52px",
            "--cart-rotate": "-15deg",
            duration: 0.2,
          },
          {
            "--cart-x": "104px",
            "--cart-rotate": "0deg",
            duration: 0.2,
            clearProps: true,
            onComplete() {
              button.style.overflow = "hidden";
              button.style.setProperty("--text-o", 0);
              button.style.setProperty("--text-x", "0px");
              button.style.setProperty("--cart-x", "-104px");
            },
          },
          {
            "--text-o": 1,
            "--text-x": "12px",
            "--cart-x": "-48px",
            "--cart-scale": 0.75,
            duration: 0.25,
            clearProps: true,
            onComplete() {
              button.classList.remove("active");
            },
          },
        ],
      });
      gsap.to(button, {
        keyframes: [
          {
            "--text-o": 0,
            duration: 0.3,
          },
        ],
      });
      gsap.to(morph, {
        keyframes: [
          {
            morphSVG:
              "M0 12C6 12 20 10 32 0C43.9024 9.99999 58 12 64 12V13H0V12Z",
            duration: 0.25,
            ease: "power1.out",
          },
          {
            morphSVG: "M0 12C6 12 17 12 32 12C47.9024 12 58 12 64 12V13H0V12Z",
            duration: 0.15,
            ease: "none",
          },
        ],
      });
      gsap.to(shirt, {
        keyframes: [
          {
            morphSVG:
              "M4.99997 3L8.99997 1.5C8.99997 1.5 10.6901 3 12 3C13.3098 3 15 1.5 15 1.5L19 3L23.5 8L20.5 11L19 9.5L18 22.5C18 22.5 14 21.5 12 21.5C10 21.5 5.99997 22.5 5.99997 22.5L4.99997 9.5L3.5 11L0.5 8L4.99997 3Z",
            duration: 0.25,
            delay: 0.25,
          },
          {
            morphSVG:
              "M4.99997 3L8.99997 1.5C8.99997 1.5 10.6901 3 12 3C13.3098 3 15 1.5 15 1.5L19 3L23.5 8L20.5 11L19 9.5L18.5 22.5C18.5 22.5 13.5 22.5 12 22.5C10.5 22.5 5.5 22.5 5.5 22.5L4.99997 9.5L3.5 11L0.5 8L4.99997 3Z",
            duration: 0.85,
            ease: "elastic.out(1, .5)",
          },
          {
            morphSVG:
              "M4.99997 3L8.99997 1.5C8.99997 1.5 10.6901 3 12 3C13.3098 3 15 1.5 15 1.5L19 3L22.5 8L19.5 10.5L19 9.5L17.1781 18.6093C17.062 19.1901 16.778 19.7249 16.3351 20.1181C15.4265 20.925 13.7133 22.3147 12 23C10.2868 22.3147 8.57355 20.925 7.66487 20.1181C7.22198 19.7249 6.93798 19.1901 6.82183 18.6093L4.99997 9.5L4.5 10.5L1.5 8L4.99997 3Z",
            duration: 0,
            delay: 1.25,
          },
        ],
      });
    });
  });
</script>

{% endblock %}
